<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Portal - EduQuest</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Sidebar and Layout styles are now in style.css for better responsiveness */

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 2.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.875rem 1rem;
            color: var(--text-muted);
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            transition: all 0.2s;
        }

        .nav-link:hover,
        .nav-link.active {
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary);
        }

        .nav-link i {
            width: 20px;
            text-align: center;
        }

        /* Main Content Wrapper - Fixes spacing and overflow */
        .main-content {
            padding: 2rem;
            width: 100%;
            overflow-x: hidden;
        }

        /* Header & Content */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        /* Section Visibility & Transitions */
        /* Section Visibility */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.4s ease-out;
        }

        /* Dashboard Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            padding: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            /* Ensure text truncation or wrap */
            min-width: 0;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: white;
            margin-top: 0.5rem;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .stat-sub {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 5px;
        }

        .stat-icon {
            font-size: 2.5rem;
            opacity: 0.2;
        }

        /* QP Generator Styles */
        .qp-setup-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        /* Dashboard Charts - Made Responsive */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
    </style>
</head>

<body>

    <div class="layout">
        <nav class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="logo text-gradient"
                    style="text-decoration: none; font-size: 1.5rem; font-weight: 800; display: flex; align-items: center; gap: 10px;">
                    <i class="fa-solid fa-graduation-cap"></i> <span>EduQuest</span>
                </a>

            </div>

            <a href="#" class="nav-link active" onclick="showSection('dashboard', this)">
                <i class="fa-solid fa-gauge-high"></i> Dashboard
            </a>
            <a href="#" class="nav-link" onclick="showSection('programs', this)">
                <i class="fa-solid fa-sitemap"></i> Programs
            </a>
            <a href="#" class="nav-link" onclick="showSection('courses', this)">
                <i class="fa-solid fa-book-open"></i> Assignments
            </a>
            <a href="#" class="nav-link" onclick="showSection('faculty', this)">
                <i class="fa-solid fa-chalkboard-user"></i> Faculty
            </a>

            <div style="margin: 1rem 0; border-top: 1px solid var(--border);"></div>
            <small
                style="color: var(--text-muted); margin-bottom: 0.5rem; padding-left: 1rem; text-transform: uppercase; font-size: 0.7rem; letter-spacing: 1px;">Evaluation</small>

            <a href="#" class="nav-link" onclick="showSection('qbank', this)">
                <i class="fa-solid fa-database"></i> Question Bank
            </a>
            <a href="#" class="nav-link" onclick="showSection('qp-generator', this)">
                <i class="fa-solid fa-file-invoice"></i> Generate QP
            </a>

            <div style="margin-top: auto;">
                <a href="index.html" class="nav-link" style="color: var(--secondary);">
                    <i class="fa-solid fa-arrow-right-from-bracket"></i> Logout
                </a>
            </div>
        </nav>

        <main class="main-content">
            <!-- Header -->
            <div class="header">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <button class="menu-toggle-btn" onclick="toggleSidebar()">
                        <i class="fa-solid fa-bars"></i>
                    </button>
                    <div>
                        <h2 id="page-title">Admin Dashboard</h2>
                        <p style="color: var(--text-muted);">System Overview & Analytics</p>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem; align-items: center;">
                    <div style="position: relative;">
                        <button onclick="toggleNotificationDropdown()" class="btn btn-secondary"
                            style="position: relative;">
                            <i class="fa-solid fa-bell"></i>
                            <span
                                style="position: absolute; top: 0px; right: 0px; width: 8px; height: 8px; background: var(--text-danger); border-radius: 50%;"></span>
                        </button>

                        <div id="notification-dropdown" class="glass-panel"
                            style="display: none; position: absolute; right: 0; top: 110%; width: 300px; padding: 0; z-index: 100; overflow: hidden;">
                            <div
                                style="padding: 1rem; border-bottom: 1px solid var(--border); background: rgba(255,255,255,0.05);">
                                <h4 style="margin: 0;">Notifications <span
                                        style="font-size: 0.8rem; background: var(--primary); padding: 2px 6px; border-radius: 4px; margin-left: 0.5rem;">2</span>
                                </h4>
                            </div>
                            <div style="max-height: 300px; overflow-y: auto;">
                                <div style="padding: 1rem; border-bottom: 1px solid var(--border);">
                                    <div style="display: flex; gap: 0.75rem;">
                                        <div style="color: var(--secondary);"><i class="fa-solid fa-server"></i></div>
                                        <div>
                                            <div style="font-weight: 500; font-size: 0.9rem; margin-bottom: 0.25rem;">
                                                System Maintenance</div>
                                            <div style="font-size: 0.8rem; color: var(--text-muted);">Scheduled
                                                maintenance at 2:00 AM.</div>
                                            <div
                                                style="font-size: 0.7rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                2 mins ago</div>
                                        </div>
                                    </div>
                                </div>
                                <div style="padding: 1rem;">
                                    <div style="display: flex; gap: 0.75rem;">
                                        <div style="color: var(--text-danger);"><i
                                                class="fa-solid fa-circle-exclamation"></i></div>
                                        <div>
                                            <div style="font-weight: 500; font-size: 0.9rem; margin-bottom: 0.25rem;">
                                                Storage Alert</div>
                                            <div style="font-size: 0.8rem; color: var(--text-muted);">Server storage is
                                                at 85% capacity.</div>
                                            <div
                                                style="font-size: 0.7rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                1 hour ago</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div
                                style="padding: 0.75rem; text-align: center; border-top: 1px solid var(--border); font-size: 0.8rem;">
                                <a href="#" style="color: var(--secondary); text-decoration: none;">View All</a>
                            </div>
                        </div>
                    </div>

                    <div style="position: relative;">
                        <button onclick="toggleProfileDropdown()"
                            style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, var(--primary), var(--secondary)); border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 1rem;">
                            A
                        </button>

                        <!-- Dropdown Menu -->
                        <div id="header-profile-dropdown" class="glass-panel"
                            style="display: none; position: absolute; right: 0; top: 110%; width: 200px; padding: 0.5rem; z-index: 100;">
                            <div
                                style="padding: 0.75rem 1rem; border-bottom: 1px solid var(--border); margin-bottom: 0.5rem;">
                                <div style="font-weight: 600;">System Admin</div>
                                <div style="font-size: 0.8rem; color: var(--text-muted);">Administrator</div>
                            </div>
                            <a href="index.html" class="nav-link"
                                style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; color: var(--text-danger); text-decoration: none; border-radius: 4px;">
                                <i class="fa-solid fa-arrow-right-from-bracket"></i> Logout
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <!-- 1. System Summary (Counters) -->
                <div class="stats-grid">
                    <div class="glass-panel stat-card">
                        <div>
                            <div class="stat-label">Programs</div>
                            <div class="stat-value" id="stats-programs">0</div>
                            <div class="stat-sub" id="sub-programs">0 Active</div>
                        </div>
                        <i class="fa-solid fa-layer-group stat-icon" style="color: var(--primary);"></i>
                    </div>
                    <div class="glass-panel stat-card">
                        <div>
                            <div class="stat-label">Branches</div>
                            <div class="stat-value" id="stats-branches">0</div>
                            <div class="stat-sub" id="sub-branches">0 Active</div>
                        </div>
                        <i class="fa-solid fa-code-branch stat-icon" style="color: #ec4899;"></i>
                    </div>
                    <div class="glass-panel stat-card">
                        <div>
                            <div class="stat-label">Active Courses</div>
                            <div class="stat-value" id="stats-courses">0</div>
                            <div class="stat-sub" id="sub-courses">0 Total</div>
                        </div>
                        <i class="fa-solid fa-book stat-icon" style="color: #10b981;"></i>
                    </div>
                    <div class="glass-panel stat-card">
                        <div>
                            <div class="stat-label">Faculty</div>
                            <div class="stat-value" id="stats-faculty">0</div>
                            <div class="stat-sub" id="sub-faculty">0 Active</div>
                        </div>
                        <i class="fa-solid fa-users stat-icon" style="color: #f59e0b;"></i>
                    </div>
                </div>

                <!-- 2. Data Visualization -->
                <div class="charts-grid">
                    <div class="glass-panel" style="padding: 1.5rem;">
                        <h3 style="margin-bottom: 1rem; font-size: 1.1rem;">Faculty Distribution</h3>
                        <canvas id="facultyChart" style="max-height: 250px;"></canvas>
                    </div>
                    <div class="glass-panel" style="padding: 1.5rem;">
                        <h3 style="margin-bottom: 1rem; font-size: 1.1rem;">Courses per Branch</h3>
                        <canvas id="coursesChart" style="max-height: 250px;"></canvas>
                    </div>
                </div>

                <!-- 3. Control Center / Alerts -->
                <div class="glass-panel" style="padding: 1.5rem;">
                    <h3 style="margin-bottom: 1rem; color: #f87171;"> <i class="fa-solid fa-triangle-exclamation"></i>
                        Action Required</h3>
                    <div id="alerts-container">
                        <!-- Dynamic Alerts will be inserted here -->
                    </div>

                </div> <!-- End Control Center -->
            </div> <!-- End Dashboard Section -->

            <!-- Programs Section -->
            <div id="programs" class="section">
                <!-- Regulation Management UI -->
                <div class="glass-panel" style="padding: 2rem; margin-bottom: 2rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h3>Regulation Management</h3>
                        <button class="btn btn-primary" onclick="openRegulationModal()">
                            <i class="fa-solid fa-plus"></i> Add Regulation
                        </button>
                    </div>

                    <table style="width: 100%; border-collapse: collapse; color: var(--text-muted);">
                        <thead>
                            <tr style="border-bottom: 1px solid var(--border); text-align: left;">
                                <th style="padding: 1rem;">Regulation Name</th>
                                <th>Academic Year</th>
                                <th>Status</th>
                                <th style="text-align: right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="regulation-table-body">
                            <!-- Dynamic Content -->
                        </tbody>
                    </table>
                </div>

                <!-- Regulation Modal -->
                <div id="regulation-modal"
                    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                    <div class="glass-panel" style="width: 100%; max-width: 500px; padding: 2rem;">
                        <h3 id="reg-modal-title" style="margin-bottom: 1.5rem;">Add Regulation</h3>
                        <form id="regulation-form">
                            <input type="hidden" id="r-id">

                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Regulation
                                Code</label>
                            <input type="text" id="r-name" required placeholder="e.g. R23" style="margin-bottom: 1rem;">

                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Academic
                                Year</label>
                            <input type="text" id="r-year" required placeholder="e.g. 2023-2024"
                                style="margin-bottom: 1rem;">

                            <label
                                style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Status</label>
                            <select id="r-status" style="margin-bottom: 2rem;">
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>

                            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary"
                                    onclick="closeRegulationModal()">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save Regulation</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="glass-panel" style="padding: 2rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h3>Program Management</h3>
                        <button class="btn btn-primary" onclick="openProgramModal()">
                            <i class="fa-solid fa-plus"></i> Add New Program
                        </button>
                    </div>

                    <!-- Program Table -->
                    <table style="width: 100%; border-collapse: collapse; color: var(--text-muted);">
                        <thead>
                            <tr style="border-bottom: 1px solid var(--border); text-align: left;">
                                <th style="padding: 1rem;">Program Name</th>
                                <th>Code</th>
                                <th>Duration (Yrs)</th>
                                <th>Status</th>
                                <th style="text-align: right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="program-table-body">
                            <!-- Dynamic Content -->
                        </tbody>
                    </table>
                </div>

                <!-- Program Modal -->
                <div id="program-modal"
                    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                    <div class="glass-panel" style="width: 100%; max-width: 500px; padding: 2rem;">
                        <h3 id="modal-title" style="margin-bottom: 1.5rem;">Add Program</h3>
                        <form id="program-form">
                            <input type="hidden" id="p-id">

                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Program
                                Name</label>
                            <input type="text" id="p-name" required placeholder="e.g. B.Tech Computer Science"
                                style="margin-bottom: 1rem;">

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Program
                                        Code</label>
                                    <input type="text" id="p-code" required placeholder="e.g. CSE"
                                        style="margin-bottom: 1rem;">
                                </div>
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Duration
                                        (Years)</label>
                                    <input type="number" id="p-duration" required min="1" max="5" value="4"
                                        style="margin-bottom: 1rem;">
                                </div>
                            </div>

                            <label
                                style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Status</label>
                            <select id="p-status" style="margin-bottom: 2rem;">
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>

                            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary"
                                    onclick="closeProgramModal()">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save Program</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Branch Management UI -->
                <div class="glass-panel" style="padding: 2rem; margin-top: 2rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h3>Branch Management (Master)</h3>
                        <button class="btn btn-primary" onclick="openBranchModal()">
                            <i class="fa-solid fa-plus"></i> Add Master Branch
                        </button>
                    </div>

                    <table style="width: 100%; border-collapse: collapse; color: var(--text-muted);">
                        <thead>
                            <tr style="border-bottom: 1px solid var(--border); text-align: left;">
                                <th style="padding: 1rem;">Branch Name</th>
                                <th>Code</th>
                                <th>Status</th>
                                <th style="text-align: right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="branch-table-body">
                            <!-- Dynamic Content -->
                        </tbody>
                    </table>
                </div>

                <!-- Branch Modal -->
                <div id="branch-modal"
                    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                    <div class="glass-panel" style="width: 100%; max-width: 500px; padding: 2rem;">
                        <h3 id="branch-modal-title" style="margin-bottom: 1.5rem;">Add Master Branch</h3>
                        <form id="branch-form">
                            <input type="hidden" id="b-id">

                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Branch
                                Name</label>
                            <input type="text" id="b-name" required placeholder="e.g. Computer Science"
                                style="margin-bottom: 1rem;">

                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Branch
                                Code</label>
                            <input type="text" id="b-code" required placeholder="e.g. CSE" style="margin-bottom: 1rem;">

                            <label
                                style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Status</label>
                            <select id="b-status" style="margin-bottom: 2rem;">
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>

                            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary"
                                    onclick="closeBranchModal()">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save Branch</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Program-Branch Mapping UI -->
                <div class="glass-panel" style="padding: 2rem; margin-top: 2rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h3>Program - Branch Mapping</h3>
                        <button class="btn btn-primary" onclick="openMappingModal()">
                            <i class="fa-solid fa-link"></i> Map Branch
                        </button>
                    </div>

                    <table style="width: 100%; border-collapse: collapse; color: var(--text-muted);">
                        <thead>
                            <tr style="border-bottom: 1px solid var(--border); text-align: left;">
                                <th style="padding: 1rem;">Program</th>
                                <th>Branch</th>
                                <th>Status</th>
                                <th style="text-align: right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="mapping-table-body">
                            <!-- Dynamic Content -->
                        </tbody>
                    </table>
                </div>

                <!-- Mapping Modal -->
                <div id="mapping-modal"
                    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                    <div class="glass-panel" style="width: 100%; max-width: 500px; padding: 2rem;">
                        <h3 id="mapping-modal-title" style="margin-bottom: 1.5rem;">New Mapping</h3>
                        <form id="mapping-form">
                            <input type="hidden" id="m-id">

                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Select
                                Program</label>
                            <select id="m-program" required style="margin-bottom: 1rem;">
                                <!-- Dynamic Active Programs -->
                            </select>

                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Select
                                Branch</label>
                            <select id="m-branch" required style="margin-bottom: 1rem;">
                                <!-- Dynamic Active Branches -->
                            </select>

                            <label
                                style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Status</label>
                            <select id="m-status" style="margin-bottom: 2rem;">
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>

                            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary"
                                    onclick="closeMappingModal()">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save Mapping</button>
                            </div>
                        </form>
                    </div>
                </div>

            </div>

            <!-- Course Management Section -->
            <div id="courses" class="section">
                <div class="glass-panel" style="padding: 2rem; margin-bottom: 2rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h3>Course Management</h3>
                        <button class="btn btn-primary" onclick="openCourseModal()">
                            <i class="fa-solid fa-plus"></i> Add Course
                        </button>
                    </div>

                    <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap;">
                        <select id="course-filter-reg" class="glass-input"
                            style="width: 200px; padding: 0.5rem; background: var(--bg-card); color: white; border: 1px solid var(--border); border-radius: 4px;"
                            onchange="filterCoursesByReg()">
                            <option value="">Select Regulation...</option>
                        </select>
                        <select id="course-filter-prog" class="glass-input"
                            style="width: 200px; padding: 0.5rem; background: var(--bg-card); color: white; border: 1px solid var(--border); border-radius: 4px;"
                            onchange="filterCoursesByProg()" disabled>
                            <option value="">Select Program...</option>
                        </select>
                        <select id="course-filter-branch" class="glass-input"
                            style="width: 200px; padding: 0.5rem; background: var(--bg-card); color: white; border: 1px solid var(--border); border-radius: 4px;"
                            onchange="loadCourses()" disabled>
                            <option value="">Select Branch...</option>
                        </select>
                        <button class="btn btn-secondary" onclick="resetCourseFilters()"><i
                                class="fa-solid fa-rotate-right"></i></button>
                    </div>

                    <table style="width: 100%; border-collapse: collapse; color: var(--text-muted);">
                        <thead>
                            <tr style="border-bottom: 1px solid var(--border); text-align: left;">
                                <th style="padding: 1rem;">Code</th>
                                <th>Course Name</th>
                                <th>Mapping (Prog-Branch)</th>
                                <th>Reg</th>
                                <th>Sem</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th style="text-align: right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="course-table-body">
                            <!-- Dynamic Content -->
                        </tbody>
                    </table>
                </div>

                <!-- Course Modal -->
                <div id="course-modal"
                    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                    <div class="glass-panel" style="width: 100%; max-width: 600px; padding: 2rem;">
                        <h3 id="course-modal-title" style="margin-bottom: 1.5rem;">Add Course</h3>
                        <form id="course-form">
                            <input type="hidden" id="c-id">

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Regulation</label>
                                    <select id="c-reg" required style="margin-bottom: 1rem;">
                                        <!-- Dynamic Active Regulations -->
                                    </select>
                                </div>
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Program
                                        - Branch</label>
                                    <select id="c-mapping" required style="margin-bottom: 1rem;">
                                        <!-- Dynamic Active Mappings -->
                                    </select>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1rem;">
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Course
                                        Name</label>
                                    <input type="text" id="c-name" required placeholder="e.g. Artificial Intelligence"
                                        style="margin-bottom: 1rem;">
                                </div>
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Course
                                        Code</label>
                                    <input type="text" id="c-code" required placeholder="e.g. 23AI301"
                                        style="margin-bottom: 1rem;">
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem;">
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Year</label>
                                    <select id="c-year" required style="margin-bottom: 1rem;">
                                        <option value="I">I</option>
                                        <option value="II">II</option>
                                        <option value="III">III</option>
                                        <option value="IV">IV</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Semester</label>
                                    <select id="c-sem" required style="margin-bottom: 1rem;">
                                        <option value="I">I</option>
                                        <option value="II">II</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Credits</label>
                                    <input type="number" id="c-credits" required min="1" max="10" placeholder="3"
                                        style="margin-bottom: 1rem;">
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Course
                                        Type</label>
                                    <select id="c-type" required style="margin-bottom: 1rem;">
                                        <option value="Theory">Theory</option>
                                        <option value="Lab">Lab</option>
                                        <option value="Project">Project</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Category</label>
                                    <select id="c-cat" required style="margin-bottom: 1rem;">
                                        <option value="Core">Core</option>
                                        <option value="Professional Elective">Professional Elective</option>
                                        <option value="Open Elective">Open Elective</option>
                                    </select>
                                </div>
                            </div>

                            <label
                                style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Status</label>
                            <select id="c-status" style="margin-bottom: 2rem;">
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>

                            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary"
                                    onclick="closeCourseModal()">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save Course</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>



            <!-- Faculty Management Section -->
            <div id="faculty" class="section">
                <div class="glass-panel" style="padding: 2rem; margin-bottom: 2rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h3>Faculty Management</h3>
                        <div style="display: flex; gap: 1rem;">
                            <button class="btn btn-secondary" onclick="openBulkFacultyModal()">
                                <i class="fa-solid fa-file-csv"></i> Bulk Upload
                            </button>
                            <button class="btn btn-primary" onclick="openFacultyModal()">
                                <i class="fa-solid fa-user-plus"></i> Add Faculty
                            </button>
                        </div>
                    </div>

                    <table style="width: 100%; border-collapse: collapse; color: var(--text-muted);">
                        <thead>
                            <tr style="border-bottom: 1px solid var(--border); text-align: left;">
                                <th style="padding: 1rem;">Emp ID</th>
                                <th>Name</th>
                                <th>Branch</th>
                                <th>Email / Phone</th>
                                <th>Role</th>
                                <th>Status</th>
                                <th style="text-align: right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="faculty-table-body">
                            <!-- Dynamic Content -->
                        </tbody>
                    </table>
                </div>

                <!-- Faculty Modal -->
                <div id="faculty-modal"
                    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                    <div class="glass-panel" style="width: 100%; max-width: 600px; padding: 2rem;">
                        <h3 id="faculty-modal-title" style="margin-bottom: 1.5rem;">Add Faculty</h3>
                        <form id="faculty-form">
                            <input type="hidden" id="f-id">

                            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 1rem;">
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Title</label>
                                    <select id="f-title" required style="margin-bottom: 1rem;">
                                        <option value="Dr.">Dr.</option>
                                        <option value="Prof.">Prof.</option>
                                        <option value="Mr.">Mr.</option>
                                        <option value="Ms.">Ms.</option>
                                        <option value="Mrs.">Mrs.</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Full
                                        Name</label>
                                    <input type="text" id="f-name" required placeholder="e.g. Rahul Sharma"
                                        style="margin-bottom: 1rem;">
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div>
                                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Emp
                                        ID</label>
                                    <input type="text" id="f-empid" required placeholder="FAC001"
                                        style="margin-bottom: 1rem;">
                                </div>
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Branch</label>
                                    <select id="f-branch" required style="margin-bottom: 1rem;">
                                        <!-- Dynamic Active Branches -->
                                    </select>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Email</label>
                                    <input type="email" id="f-email" required placeholder="email@websaga.edu"
                                        style="margin-bottom: 1rem;">
                                </div>
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Phone</label>
                                    <input type="tel" id="f-phone" required placeholder="9876543210"
                                        style="margin-bottom: 1rem;">
                                </div>
                            </div>

                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Role &
                                Status</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem;">
                                <select id="f-type">
                                    <option value="Faculty">Faculty</option>
                                    <option value="Admin">Admin</option>
                                    <option value="HOD">HOD</option>
                                </select>
                                <select id="f-status">
                                    <option value="Active">Active</option>
                                    <option value="Inactive">Inactive</option>
                                </select>
                            </div>

                            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary"
                                    onclick="closeFacultyModal()">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save & Generator Password</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Bulk Upload Modal -->
                <div id="bulk-modal"
                    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                    <div class="glass-panel" style="width: 100%; max-width: 500px; padding: 2rem;">
                        <h3 style="margin-bottom: 1.5rem;">Bulk Upload Faculty</h3>
                        <p style="color: var(--text-muted); margin-bottom: 1rem; font-size: 0.9rem;">
                            Upload a CSV file or paste CSV data below.<br>
                            Format: Name, Email, Phone, BranchCode, EmpID
                        </p>
                        <textarea id="bulk-data" class="glass-input" rows="5"
                            placeholder="John Doe, john@test.com, 9998887776, CSE, FAC005"
                            style="width: 100%; margin-bottom: 1.5rem; font-family: monospace;"></textarea>

                        <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                            <button class="btn btn-secondary" onclick="closeBulkFacultyModal()">Cancel</button>
                            <button class="btn btn-primary" onclick="handleBulkUpload()">Process Upload</button>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Faculty-Course Mapping Section -->
            <div id="fc-mapping" class="section">
                <div class="glass-panel" style="padding: 2rem; margin-bottom: 2rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h3>Faculty - Course Mapping</h3>
                        <button class="btn btn-primary" onclick="openFCModal()">
                            <i class="fa-solid fa-link"></i> Map Course
                        </button>
                    </div>

                    <table style="width: 100%; border-collapse: collapse; color: var(--text-muted);">
                        <thead>
                            <tr style="border-bottom: 1px solid var(--border); text-align: left;">
                                <th style="padding: 1rem;">Faculty</th>
                                <th>Course</th>
                                <th>Type</th>
                                <th>Year-Sem</th>
                                <th>Academic Year</th>
                                <th>Status</th>
                                <th style="text-align: right;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="fc-table-body">
                            <!-- Dynamic Content -->
                        </tbody>
                    </table>
                </div>

                <!-- FC Modal -->
                <div id="fc-modal"
                    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                    <div class="glass-panel" style="width: 100%; max-width: 500px; padding: 2rem;">
                        <h3 id="fc-modal-title" style="margin-bottom: 1.5rem;">Map Faculty to Course</h3>
                        <form id="fc-form">
                            <input type="hidden" id="fc-id">

                            <div style="margin-bottom: 1rem;">
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Academic
                                    Year</label>
                                <input type="text" id="fc-acyear" readonly
                                    style="background: rgba(255,255,255,0.05); cursor: not-allowed; color: var(--text-muted);">
                            </div>

                            <div style="margin-bottom: 1rem;">
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Select
                                    Faculty</label>
                                <select id="fc-faculty" required>
                                    <!-- Active Faculty -->
                                </select>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 1rem; margin-bottom: 1rem;">
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Course
                                        Type</label>
                                    <select id="fc-type" required onchange="filterCoursesByType()">
                                        <option value="">Select...</option>
                                        <option value="Theory">Theory</option>
                                        <option value="Lab">Lab</option>
                                        <option value="Project">Project</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Select
                                        Course</label>
                                    <select id="fc-course" required disabled>
                                        <option value="">Select Type First...</option>
                                    </select>
                                </div>
                            </div>

                            <label
                                style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Status</label>
                            <select id="fc-status" style="margin-bottom: 2rem;">
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>

                            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary" onclick="closeFCModal()">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save Mapping</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>



            <!-- Course Plugins (Masters) Section -->
            <div id="course-plugins" class="section">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">

                    <!-- Bloom's Taxonomy -->
                    <div class="glass-panel" style="padding: 1.5rem;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h4>Bloom's Level</h4>
                            <button class="btn-icon" onclick="openPluginModal('bloom')"><i
                                    class="fa-solid fa-plus"></i></button>
                        </div>
                        <div style="max-height: 300px; overflow-y: auto;">
                            <table style="width: 100%; font-size: 0.9rem;">
                                <tbody id="bloom-table-body"></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Difficulty Level -->
                    <div class="glass-panel" style="padding: 1.5rem;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h4>Difficulty Level</h4>
                            <button class="btn-icon" onclick="openPluginModal('difficulty')"><i
                                    class="fa-solid fa-plus"></i></button>
                        </div>
                        <div style="max-height: 300px; overflow-y: auto;">
                            <table style="width: 100%; font-size: 0.9rem;">
                                <tbody id="difficulty-table-body"></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Course Units -->
                    <div class="glass-panel" style="padding: 1.5rem;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h4>Course Units</h4>
                            <button class="btn-icon" onclick="openPluginModal('unit')"><i
                                    class="fa-solid fa-plus"></i></button>
                        </div>
                        <div style="max-height: 300px; overflow-y: auto;">
                            <table style="width: 100%; font-size: 0.9rem;">
                                <tbody id="unit-table-body"></tbody>
                            </table>
                        </div>
                    </div>

                </div>

                <!-- Generic Plugin Modal -->
                <div id="plugin-modal"
                    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
                    <div class="glass-panel" style="width: 100%; max-width: 400px; padding: 2rem;">
                        <h3 id="plugin-modal-title" style="margin-bottom: 1.5rem;">Add Item</h3>
                        <form id="plugin-form">
                            <input type="hidden" id="pl-type">
                            <input type="hidden" id="pl-id">

                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Name</label>
                            <input type="text" id="pl-name" required placeholder="Name" style="margin-bottom: 1rem;">

                            <label
                                style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Status</label>
                            <select id="pl-status" style="margin-bottom: 2rem;">
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>

                            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                                <button type="button" class="btn btn-secondary"
                                    onclick="closePluginModal()">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div id="qp-generator" class="section">
                <!-- Step 1: Configuration -->
                <div class="glass-panel" style="padding: 2rem; margin-bottom: 2rem;">
                    <h3 style="margin-bottom: 2rem; color: var(--secondary);">1. Exam Configuration</h3>
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
                        <div>
                            <label
                                style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Program</label>
                            <select id="qp-program" onchange="handleQPProgChange()"
                                style="width: 100%; padding: 0.8rem; background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: white; border-radius: 8px;">
                                <option value="">Select Program...</option>
                            </select>
                        </div>
                        <div>
                            <label
                                style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Course</label>
                            <select id="qp-course" onchange="handleQPCourseChange()" disabled
                                style="width: 100%; padding: 0.8rem; background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: white; border-radius: 8px;">
                                <option value="">Select Program First...</option>
                            </select>
                        </div>
                        <div>
                            <label
                                style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Assessment</label>
                            <select id="qp-assessment"
                                style="width: 100%; padding: 0.8rem; background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: white; border-radius: 8px;">
                                <option value="Mid-Semester Exam 1">Mid-Semester Exam 1</option>
                                <option value="Mid-Semester Exam 2">Mid-Semester Exam 2</option>
                                <option value="Semester End Exam">Semester End Exam</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-muted);">Date</label>
                            <input type="date" id="qp-date"
                                style="width: 100%; padding: 0.8rem; background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: white; border-radius: 8px;">
                        </div>
                    </div>
                    <!-- Auto-filled Info -->
                    <div
                        style="display: flex; gap: 2rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border); color: var(--text-muted); font-size: 0.9rem;">
                        <span><i class="fa-solid fa-scroll"></i> Reg: <strong id="qp-reg"
                                style="color: white;">-</strong></span>
                        <span><i class="fa-solid fa-graduation-cap"></i> Year/Sem: <strong id="qp-sem"
                                style="color: white;">-</strong></span>
                        <span><i class="fa-solid fa-calendar"></i> AY: <strong id="qp-ay"
                                style="color: white;">-</strong></span>
                    </div>
                </div>

                <!-- Step 2: Blueprint -->
                <div class="glass-panel" style="padding: 2rem; margin-bottom: 2rem;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <h3 style="color: var(--secondary);">2. Paper Blueprint</h3>
                        <button class="btn btn-secondary" onclick="addBlueprintRow()"><i class="fa-solid fa-plus"></i>
                            Add
                            Section</button>
                    </div>

                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 2rem;">
                        <thead>
                            <tr
                                style="text-align: left; color: var(--text-muted); border-bottom: 1px solid var(--border);">
                                <th style="padding: 1rem;">Section Name</th>
                                <th># Questions</th>
                                <th>Marks/Q</th>
                                <th>Evaluate (Bloom)</th>
                                <th>Difficulty</th>
                                <th>Unit Filter</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="bp-table-body">
                            <!-- Rows added dynamically -->
                        </tbody>
                    </table>

                    <div style="text-align: right;">
                        <button class="btn btn-primary" onclick="generateQP()"
                            style="padding: 1rem 2rem; font-size: 1rem;">
                            <i class="fa-solid fa-wand-magic-sparkles"></i> Generate Question Paper
                        </button>
                    </div>
                </div>

                <!-- Step 3: Preview -->
                <div id="qp-preview"
                    style="display: none; background: white; color: black; padding: 40px; border-radius: 8px; font-family: 'Times New Roman', serif;">
                    <!-- Paper Header -->
                    <div
                        style="text-align: center; border-bottom: 2px solid black; padding-bottom: 20px; margin-bottom: 20px;">
                        <h2 style="margin: 0; text-transform: uppercase;">WebSaga Institute of Technology</h2>
                        <p style="margin: 5px 0;">Department of <span id="p-dept">CSE</span></p>
                        <h3 style="margin: 10px 0;" id="p-exam">Mid-Semester Exam 1</h3>
                        <div
                            style="display: flex; justify-content: space-between; font-weight: bold; margin-top: 15px;">
                            <span>Course: <span id="p-course">Data Structures</span></span>
                            <span>Max Marks: <span id="p-max-marks">30</span></span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-weight: bold;">
                            <span>Date: <span id="p-date">10/10/2026</span></span>
                            <span>Duration: 90 Mins</span>
                        </div>
                    </div>

                    <!-- Questions Container -->
                    <div id="p-questions"></div>

                    <!-- Footer Buttons -->
                    <div class="no-print"
                        style="margin-top: 40px; text-align: center; border-top: 1px solid #ddd; padding-top: 20px;">
                        <button class="btn btn-secondary"
                            onclick="document.getElementById('qp-preview').style.display='none'">Close</button>
                        <button class="btn btn-primary" onclick="window.print()"><i class="fa-solid fa-print"></i> Print
                            /
                            Save
                            PDF</button>
                    </div>
                </div>
            </div>

            <!-- Question Bank Section -->
            <div id="qbank" class="section">
                <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                    <h3>Question Bank</h3>
                    <button class="btn btn-primary"><i class="fa-solid fa-plus"></i> Add Question</button>
                </div>

                <div class="glass-panel" style="padding: 1.5rem;">
                    <!-- Filter Bar -->
                    <div
                        style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem;">
                        <select>
                            <option>Select Course</option>
                            <option>CS101 - Data Structures</option>
                        </select>
                        <select>
                            <option>Difficulty</option>
                            <option>Easy</option>
                            <option>Medium</option>
                            <option>Hard</option>
                        </select>
                        <select>
                            <option>Bloom's Taxonomy</option>
                            <option>Remember</option>
                            <option>Understand</option>
                            <option>Apply</option>
                            <option>Analyze</option>
                        </select>
                        <button class="btn btn-secondary">Filter</button>
                    </div>

                    <!-- Questions List -->
                    <div id="admin-questions-list" style="max-height: 500px; overflow-y: auto;">
                        <!-- Dynamic Content -->
                    </div>
                </div>
            </div>



        </main>
    </div>

    <script src="data.js"></script>
    <script>
        // Session Check
        const role = localStorage.getItem('user_role');
        if (role !== 'admin') {
            window.location.href = 'index.html';
        }
    </script>
    <script src="admin-dashboard.js"></script>
    <script>
        function showSection(sectionId, linkElement) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            // Show target section
            document.getElementById(sectionId).classList.add('active');

            // Update nav state
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            linkElement.classList.add('active');

            // Update Title
            const titles = {
                'dashboard': 'Admin Dashboard',
                'programs': 'Program Management',
                'courses': 'Course Allocations',
                'faculty': 'Faculty Management',
                'qbank': 'Question Bank',
                'qbank': 'Question Bank',
                'qp-generator': 'QP Generator'
            };
            document.getElementById('page-title').innerText = titles[sectionId];

            if (sectionId === 'qp-generator' && typeof initQP === 'function') {
                initQP();
            }
        }

        function toggleProfileDropdown() {
            const el = document.getElementById('header-profile-dropdown');
            const notif = document.getElementById('notification-dropdown');
            if (notif) notif.style.display = 'none'; // Close other
            if (el.style.display === 'none') {
                el.style.display = 'block';
            } else {
                el.style.display = 'none';
            }
        }

        function toggleNotificationDropdown() {
            const el = document.getElementById('notification-dropdown');
            const prof = document.getElementById('header-profile-dropdown');
            if (prof) prof.style.display = 'none'; // Close other
            if (el.style.display === 'none') {
                el.style.display = 'block';
            } else {
                el.style.display = 'none';
            }
        }

        window.addEventListener('click', function (e) {
            const dropdown = document.getElementById('header-profile-dropdown');
            const notif = document.getElementById('notification-dropdown');

            // Close Profile
            if (dropdown && dropdown.style.display === 'block') {
                if (!dropdown.contains(e.target) && !e.target.closest('button[onclick="toggleProfileDropdown()"]')) {
                    dropdown.style.display = 'none';
                }
            }

            // Close Notification
            if (notif && notif.style.display === 'block') {
                if (!notif.contains(e.target) && !e.target.closest('button[onclick="toggleNotificationDropdown()"]')) {
                    notif.style.display = 'none';
                }
            }
        });

        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const layout = document.querySelector('.layout');
            sidebar.classList.toggle('collapsed');
            layout.classList.toggle('sidebar-closed');
        }
    </script>
</body>

</html>